<div class="table-container">
  <table class="table">
    <thead class="table-thead">
      <tr>
        <th class="table-th">Nombre</th>
        <th class="table-th">Descripci√≥n</th>
        <th class="table-th">Estado</th>
        <th class="table-th">Acciones</th>
      </tr>
    </thead>
    <tbody class="table-tbody">
      <tr *ngFor="let pedido of pedidos">
        <td class="table-td">{{ pedido.nombre }}</td>
        <td class="table-td">{{ pedido.camposPedidos }}</td>
        <td class="table-td">
          <span class="badge" [class.badge-completado]="pedido.estado === 'COMPLETADO'"
                              [class.badge-pendiente]="pedido.estado === 'PENDIENTE'"
                              [class.badge-tomado]="pedido.estado === 'TOMADO'">
            {{ pedido.estado }}
          </span>
        </td>
        <td class="table-td">
          <ng-container *ngIf="pedido.estado === 'COMPLETADO'">
            <button class="btn btn-create" (click)="onDownload.emit(pedido.id)">Descargar</button>
          </ng-container>
          
          <ng-container *ngIf="auth.rolSalud() || auth.rolAdmin()">
            <ng-container *ngIf="pedido.estado === 'PENDIENTE'">
              <button class="btn btn-func" (click)="onTake.emit(pedido.id)">Tomar</button>
            </ng-container>
            <ng-container *ngIf="pedido.estado === 'TOMADO'">
              <button class="btn btn-func" (click)="openCompleteDialog(pedido.id)">Completar</button>
            </ng-container>
          </ng-container>
        </td>
      </tr>
      <tr *ngIf="pedidos.length === 0">
        <td class="table-td" colspan="4">No hay pedidos cargados.</td>
      </tr>
    </tbody>
  </table>
</div>

@if (showCompleteDialog) {
  <reporte-input-dialog-pedido
    (saved)="onCompleteWithReporte.emit($event)"
    (closed)="onCloseDialog.emit()">
  </reporte-input-dialog-pedido>
}